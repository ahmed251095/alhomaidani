<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <!-- Inject cover page BEFORE external_layout in BI template -->
    <template id="inject_cover_before_external_layout_bi"
              inherit_id="bi_professional_reports_templates.modern_report_saleorder_document">

      <!-- حقن الغلاف قبل استدعاء external_layout -->
      <xpath expr="//t[@t-call='web.external_layout']" position="before">
        <t t-set="company" t-value="doc.company_id"/>

        <!-- صفحة الغلاف: خارج external_layout = بدون هيدر/فوتر -->
        <div class="page" style="padding:0; margin:0; direction:rtl; text-align:center;">
          <t t-if="company.sale_report_cover">
            <img t-att-src="'/web/image/res.company/%s/sale_report_cover' % company.id"
                 style="width:100%; height:100%; object-fit:cover; display:block; margin:0;"/>
          </t>
          <t t-else="">
            <img src="/company_sale_report_cover/static/src/img/default_cover.jpg"
                 style="width:100%; height:100%; object-fit:cover; display:block; margin:0;"/>
          </t>
        </div>
      </xpath>
    </template>

  </data>
</odoo>