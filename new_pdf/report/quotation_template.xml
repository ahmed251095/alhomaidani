<odoo>
  <template id="report_saleorder_document_ultra">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-set="company" t-value="o.company_id"/>
        <div class="page">
          <style>
            html[lang^="ar"] .ultra-header,
            html[lang^="ar"] .ultra-panels,
            html[lang^="ar"] .ultra-meta-row,
            html[lang^="ar"] .ultra-row,
            html[lang^="ar"] .ultra-totals,
            html[lang^="ar"] .ultra-terms,
            html[lang^="ar"] .ultra-lines { direction: rtl; text-align: right; }
            html[lang^="ar"] .ultra-row { grid-template-columns: 1fr 140px; }
            html[lang^="ar"] .ultra-row .k { order: 2; text-align: left; }
            html[lang^="ar"] .ultra-row .v { order: 1; }

            .ultra-header { display:flex; justify-content:space-between; gap:16px; align-items:center;
                            padding:14px 16px; border-radius:10px; margin-bottom:12px;
                            background: linear-gradient(135deg, #0d47a1, #1976d2 45%, #42a5f5); color:#fff; }
            .ultra-brand { display:flex; gap:12px; align-items:center; }
            .ultra-logo { max-height:48px; border-radius:6px; background:#fff; padding:6px; }
            .ultra-company-name{ font-weight:700; font-size:16px; }
            .ultra-company-sub{ font-size:11px; opacity:.95; }
            .ultra-doc-title{ font-size:18px; font-weight:800; letter-spacing:.3px; text-transform:uppercase; text-align:right; }
            .ultra-meta-row{ display:grid; grid-template-columns:110px 1fr; gap:8px; font-size:12px; }
            .k{ color:#374151; } .v{ font-weight:700; color:#111827; }

            .ultra-panels{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:6px; }
            .ultra-panel{ border:1px solid #e5e7eb; border-radius:10px; overflow:hidden; }
            .ultra-panel-title{ background:#f3f6fb; padding:8px 12px; font-weight:700; font-size:12px; border-bottom:1px solid #e5e7eb; }
            .ultra-panel-body{ padding:10px 12px; display:grid; gap:6px; }
            .ultra-row{ display:grid; grid-template-columns:120px 1fr; gap:8px; align-items:center; font-size:12px; }

            .ultra-lines{ width:100%; border-collapse:collapse; margin-top:8px; }
            .ultra-lines thead th{ background:#f3f6fb; font-weight:700; border-bottom:1px solid #e5e7eb; }
            .ultra-lines tbody tr:nth-child(odd){ background:#fafbff; }
            .ultra-lines td, .ultra-lines th{ padding:6px 8px; border-bottom:1px solid #f1f5f9; }

            .ultra-totals-wrapper{ margin-top:10px; }
            .ultra-totals{ border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px; display:grid; gap:6px; max-width:360px; margin-left:auto; }
            .ultra-totals .ultra-sum-row{ display:flex; justify-content:space-between; align-items:center; font-size:12px; }
            .ultra-totals .total{ border-top:1px dashed #cbd5e1; padding-top:6px; font-weight:800; font-size:14px; }
            .ultra-terms{ margin-top:12px; border:1px dashed #cbd5e1; border-radius:10px; }
            .ultra-terms .title{ background:#f8fafc; padding:8px 12px; font-weight:700; font-size:12px; border-bottom:1px dashed #cbd5e1; }
            .ultra-terms .body{ padding:10px 12px; font-size:12px; }

            .o_report_layout{ --o-report-margin-top: 10px; --o-report-margin-bottom: 10px; }
          </style>

          <!-- HEADER -->
          <div class="ultra-header">
            <div class="ultra-left">
              <div class="ultra-brand">
                <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" class="ultra-logo"/>
                <div class="ultra-company">
                  <div class="ultra-company-name"><t t-esc="company.name"/></div>
                  <div class="ultra-company-sub">
                    <t t-esc="', '.join(filter(None, [company.street or '', company.city or '', company.country_id and company.country_id.name or '']))"/>
                  </div>
                  <div class="ultra-company-sub" t-if="company.phone or company.email">
                    <t t-esc="', '.join(filter(None, [company.phone or '', company.email or '']))"/>
                  </div>
                </div>
              </div>
            </div>
            <div class="ultra-right">
              <div class="ultra-doc-title">Quotation</div>
              <div class="ultra-meta-row"><span class="k">Order #</span><span class="v"><t t-esc="o.name"/></span></div>
              <div class="ultra-meta-row"><span class="k">Date</span><span class="v"><span t-field="o.date_order" t-options='{"date_only": True}'/></span></div>
              <t t-if="o.user_id"><div class="ultra-meta-row"><span class="k">Salesperson</span><span class="v"><t t-esc="o.user_id.name"/></span></div></t>
              <t t-if="o.client_order_ref"><div class="ultra-meta-row"><span class="k">Customer Ref</span><span class="v"><t t-esc="o.client_order_ref"/></span></div></t>
            </div>
          </div>

          <!-- PANELS -->
          <div class="ultra-panels">
            <div class="ultra-panel">
              <div class="ultra-panel-title">Customer</div>
              <div class="ultra-panel-body">
                <div class="ultra-row"><span class="k">Name</span><span class="v"><t t-esc="o.partner_id.name"/></span></div>
                <t t-if="o.partner_id.vat"><div class="ultra-row"><span class="k">VAT</span><span class="v"><t t-esc="o.partner_id.vat"/></span></div></t>
                <t t-if="o.partner_id.phone or o.partner_id.mobile"><div class="ultra-row"><span class="k">Phone</span><span class="v"><t t-esc="o.partner_id.phone or o.partner_id.mobile"/></span></div></t>
                <t t-if="o.partner_id.email"><div class="ultra-row"><span class="k">Email</span><span class="v"><t t-esc="o.partner_id.email"/></span></div></t>
                <t t-if="o.partner_id.street or o.partner_id.city or o.partner_id.country_id">
                  <div class="ultra-row"><span class="k">Address</span><span class="v">
                    <t t-esc="', '.join(filter(None, [o.partner_id.street or '', o.partner_id.city or '', o.partner_id.country_id and o.partner_id.country_id.name or '']))"/>
                  </span></div>
                </t>
              </div>
            </div>
            <div class="ultra-panel">
              <div class="ultra-panel-title">Quotation Info</div>
              <div class="ultra-panel-body">
                <div class="ultra-row"><span class="k">Currency</span><span class="v"><t t-esc="o.currency_id.name"/></span></div>
                <t t-if="o.validity_date"><div class="ultra-row"><span class="k">Valid Until</span><span class="v"><span t-field="o.validity_date"/></span></div></t>
                <t t-if="o.payment_term_id"><div class="ultra-row"><span class="k">Payment Terms</span><span class="v"><t t-esc="o.payment_term_id.name"/></span></div></t>
                <t t-if="o.incoterm"><div class="ultra-row"><span class="k">Incoterm</span><span class="v"><t t-esc="o.incoterm.name"/></span></div></t>
                <t t-if="o.partner_shipping_id and o.partner_shipping_id != o.partner_id"><div class="ultra-row"><span class="k">Delivery To</span><span class="v"><t t-esc="o.partner_shipping_id.name"/></span></div></t>
              </div>
            </div>
          </div>

          <!-- LINES TABLE -->
          <table class="table table-sm ultra-lines o_main_table">
            <thead>
              <tr>
                <th>#</th><th>Description</th><th>Qty</th><th>UoM</th><th>Unit Price</th><th>Taxes</th><th>Subtotal</th>
              </tr>
            </thead>
            <tbody>
              <t t-foreach="o.order_line" t-as="line">
                <tr>
                  <td><t t-esc="line.sequence or 1"/></td>
                  <td>
                    <div><t t-esc="line.product_id.display_name or line.name"/></div>
                    <t t-if="line.name and line.name != (line.product_id.display_name or '')">
                      <small class="text-muted"><t t-esc="line.name"/></small>
                    </t>
                  </td>
                  <td class="text-right"><span t-field="line.product_uom_qty"/></td>
                  <td><t t-esc="line.product_uom and line.product_uom.name or ''"/></td>
                  <td class="text-right"><span t-field="line.price_unit" t-options='{"widget":"monetary","display_currency": o.currency_id}'/></td>
                  <td><t t-esc="', '.join(line.tax_id.mapped('name'))"/></td>
                  <td class="text-right"><span t-field="line.price_subtotal" t-options='{"widget":"monetary","display_currency": o.currency_id}'/></td>
                </tr>
              </t>
            </tbody>
          </table>

          <!-- TOTALS + TERMS -->
          <div class="ultra-totals-wrapper">
            <div class="ultra-totals">
              <div class="ultra-sum-row"><span class="k">Untaxed Amount</span><span class="v"><span t-field="o.amount_untaxed" t-options='{"widget":"monetary","display_currency": o.currency_id}'/></span></div>
              <t t-if="o.amount_tax"><div class="ultra-sum-row"><span class="k">VAT Taxes</span><span class="v"><span t-field="o.amount_tax" t-options='{"widget":"monetary","display_currency": o.currency_id}'/></span></div></t>
              <div class="ultra-sum-row total"><span class="k">Total</span><span class="v"><span t-field="o.amount_total" t-options='{"widget":"monetary","display_currency": o.currency_id}'/></span></div>
            </div>
            <t t-if="o.note">
              <div class="ultra-terms">
                <div class="title">Terms &amp; Notes</div>
                <div class="body"><t t-raw="o.note"/></div>
              </div>
            </t>
          </div>
        </div>
      </t>
    </t>
  </template>
</odoo>